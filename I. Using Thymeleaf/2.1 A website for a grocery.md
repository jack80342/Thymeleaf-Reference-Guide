### 2.1 æ‚è´§åº—ç½‘ç«™

ä¸ºäº†æ›´å¥½åœ°è§£é‡Šåœ¨ä½¿ç”¨Thymeleafå¤„ç†æ¨¡ç‰ˆæ—¶æ¶‰åŠçš„æ¦‚å¿µï¼Œæœ¬æ•™ç¨‹å°†ä¼šä½¿ç”¨ä¸€ä¸ªæ¼”ç¤ºåº”ç”¨ã€‚ä½ å¯ä»¥ä»é¡¹ç›®çš„ç½‘ç«™ä¸Šä¸‹è½½â¬ã€‚

è¿™ä¸ªåº”ç”¨æ˜¯ä¸€ä¸ªè™šæ„çš„æ‚è´§åº—çš„ç½‘ç«™ã€‚å®ƒå°†ä¼šæä¾›æˆ‘ä»¬è®¸å¤šåœºæ™¯ï¼Œæ¥å±•ç¤ºThymeleafçš„è¯¸å¤šç‰¹æ€§ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸ºåº”ç”¨å‡†å¤‡ä¸€å¥—ç®€å•çš„æ¨¡å‹å®ä½“ï¼šé€šè¿‡åˆ›å»º`è®¢å•`å–ç»™`é¡¾å®¢`çš„`äº§å“`ã€‚æˆ‘ä»¬ä¹Ÿä¼šç®¡ç†ä¸é‚£äº›`äº§å“`æœ‰å…³çš„`è¯„è®º`ã€‚

![Example application model](http://www.thymeleaf.org/doc/tutorials/3.0/images/usingthymeleaf/gtvg-model.png)

æˆ‘ä»¬çš„åº”ç”¨ä¹Ÿä¼šğŸˆ¶ï¸ä¸€ä¸ªéå¸¸ç®€å•çš„æœåŠ¡å±‚ï¼Œç”±åŒ…å«å¦‚ä¸‹æ–¹æ³•çš„`æœåŠ¡`å¯¹è±¡ç»„æˆï¼š

```java
public class ProductService {

    ...

    public List<Product> findAll() {
        return ProductRepository.getInstance().findAll();
    }

    public Product findById(Integer id) {
        return ProductRepository.getInstance().findById(id);
    }
    
}
```

åœ¨ç½‘ç»œå±‚ï¼Œæˆ‘ä»¬çš„åº”ç”¨å°†ä¼šğŸˆ¶ï¸ä¸€ä¸ªè¿‡æ»¤å™¨ã€‚å®ƒä¼šä¾æ®è¯·æ±‚çš„URLï¼Œåˆ†é…æ‰§è¡Œå¯ç”¨Thymeleafçš„å‘½ä»¤ï¼š

```java
private boolean process(HttpServletRequest request, HttpServletResponse response)
        throws ServletException {
    
    try {

        // This prevents triggering engine executions for resource URLs
        if (request.getRequestURI().startsWith("/css") ||
                request.getRequestURI().startsWith("/images") ||
                request.getRequestURI().startsWith("/favicon")) {
            return false;
        }

        
        /*
         * Query controller/URL mapping and obtain the controller
         * that will process the request. If no controller is available,
         * return false and let other filters/servlets process the request.
         */
        IGTVGController controller = this.application.resolveControllerForRequest(request);
        if (controller == null) {
            return false;
        }

        /*
         * Obtain the TemplateEngine instance.
         */
        ITemplateEngine templateEngine = this.application.getTemplateEngine();

        /*
         * Write the response headers
         */
        response.setContentType("text/html;charset=UTF-8");
        response.setHeader("Pragma", "no-cache");
        response.setHeader("Cache-Control", "no-cache");
        response.setDateHeader("Expires", 0);

        /*
         * Execute the controller and process view template,
         * writing the results to the response writer. 
         */
        controller.process(
                request, response, this.servletContext, templateEngine);
        
        return true;
        
    } catch (Exception e) {
        try {
            response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
        } catch (final IOException ignored) {
            // Just ignore this
        }
        throw new ServletException(e);
    }
    
}
```

è¿™æ˜¯æˆ‘ä»¬çš„`IGTVGController`æ¥å£ï¼š

```java
public interface IGTVGController {

    public void process(
            HttpServletRequest request, HttpServletResponse response,
            ServletContext servletContext, ITemplateEngine templateEngine);    
    
}
```

ç°åœ¨æˆ‘ä»¬è¦åšçš„å°±æ˜¯åˆ›å»º`IGTVGController`æ¥å£çš„å®ç°ï¼Œä»æœåŠ¡ä¸­å–å›æ•°æ®ï¼Œå¹¶ä½¿ç”¨`ITemplateEngine`å¯¹è±¡å¤„ç†æ¨¡ç‰ˆã€‚

æœ€åï¼Œå®ƒçœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š

![Example application home page](http://www.thymeleaf.org/doc/tutorials/3.0/images/usingthymeleaf/gtvg-view.png)

ä½†æ˜¯ï¼Œå…ˆè®©æˆ‘ä»¬çœ‹çœ‹é‚£ä¸ªæ¨¡ç‰ˆå¼•æ“æ˜¯æ€ä¹ˆè¢«åˆå§‹åŒ–çš„ã€‚